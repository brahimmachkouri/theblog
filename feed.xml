<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="/theblog/feed.xml" rel="self" type="application/atom+xml" /><link href="/theblog/" rel="alternate" type="text/html" /><updated>2025-10-21T11:14:36+02:00</updated><id>/theblog/feed.xml</id><title type="html">Mémos</title><subtitle>A static Github blog for everyone.</subtitle><author><name>Brahim MACHKOURI</name></author><entry><title type="html">Certificat - Installation d’un certificat .p12 pour un navigateur</title><link href="/theblog/syst%C3%A8me/2025/10/21/ajout-certificat-navigateur.html" rel="alternate" type="text/html" title="Certificat - Installation d’un certificat .p12 pour un navigateur" /><published>2025-10-21T13:00:00+02:00</published><updated>2025-10-21T13:00:00+02:00</updated><id>/theblog/syst%C3%A8me/2025/10/21/ajout-certificat-navigateur</id><content type="html" xml:base="/theblog/syst%C3%A8me/2025/10/21/ajout-certificat-navigateur.html"><![CDATA[<p><img src="/theblog/assets/images/creation_certif.png" alt=".p12" /></p>

<h2 id="️-guide-dinstallation-dun-certificat-p12-dans-windows-11-utilisateur-courant--navigateur-web">⚖️ Guide d’installation d’un certificat <code class="language-plaintext highlighter-rouge">.p12</code> dans Windows 11 (utilisateur courant / navigateur web)</h2>

<h3 id="-objectif">🎯 Objectif</h3>
<p>Installer un certificat client au format <code class="language-plaintext highlighter-rouge">.p12</code> pour une <strong>utilisation dans les navigateurs web</strong> tels que Edge, Chrome ou Firefox, pour <strong>l’utilisateur courant</strong>.</p>

<hr />

<h3 id="-étape-1--comprendre-le-fichier-p12">🥉 Étape 1 : Comprendre le fichier <code class="language-plaintext highlighter-rouge">.p12</code></h3>

<p>Un fichier <code class="language-plaintext highlighter-rouge">.p12</code> contient :</p>
<ul>
  <li>🔐 Le <strong>certificat utilisateur</strong></li>
  <li>🔑 La <strong>clé privée</strong></li>
  <li>🧾 Éventuellement la <strong>chaîne de certification</strong> (autorité intermédiaire / racine)</li>
</ul>

<p>Ce fichier est <strong>protégé par un mot de passe</strong>, que tu devras saisir lors de l’importation.</p>

<hr />

<h2 id="o-étape-2--importation-via-linterface-graphique">🦯o Étape 2 : Importation via l’interface graphique</h2>

<ol>
  <li><strong>Double-clique</strong> sur le fichier <code class="language-plaintext highlighter-rouge">moncertificat.p12</code></li>
  <li>Sélectionne <strong>Utilisateur actuel</strong>
    <blockquote>
      <p>car le certificat doit être disponible uniquement pour ton compte Windows</p>
    </blockquote>
  </li>
  <li>Clique sur <strong>Suivant</strong></li>
  <li>Clique sur <strong>Parcourir</strong>, puis sélectionne ton fichier <code class="language-plaintext highlighter-rouge">.p12</code></li>
  <li>Entre le <strong>mot de passe</strong> du certificat</li>
  <li>Coche :
    <ul>
      <li>✅ <em>Marquer cette clé comme exportable</em></li>
      <li>✅ <em>Inclure toutes les propriétés étendues</em></li>
    </ul>
  </li>
  <li>Sélectionne :
    <ul>
      <li><strong>Placer tous les certificats dans le magasin suivant</strong></li>
      <li>Clique sur <strong>Parcourir</strong> → choisis <strong>Personnel</strong></li>
    </ul>
  </li>
  <li>Clique sur <strong>Suivant</strong> puis <strong>Terminer</strong></li>
  <li>Un message “<strong>L’importation a réussi</strong>” s’affiche ✅</li>
</ol>

<hr />

<h2 id="-étape-3--vérification-dans-le-navigateur">🌐 Étape 3 : Vérification dans le navigateur</h2>

<h3 id="microsoft-edge--google-chrome">Microsoft Edge / Google Chrome</h3>
<ol>
  <li>Ouvre les <strong>Paramètres</strong></li>
  <li>Recherche <strong>certificats</strong></li>
  <li>Va dans :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Paramètres → Confidentialité et sécurité → Sécurité → Gérer les certificats
</code></pre></div>    </div>
  </li>
  <li>Onglet <strong>Personnel</strong> → tu dois voir ton certificat listé.</li>
</ol>

<h3 id="mozilla-firefox">Mozilla Firefox</h3>
<blockquote>
  <p>Firefox n’utilise <strong>pas</strong> le magasin Windows par défaut.</p>
</blockquote>

<ol>
  <li>Menu ☰ → <strong>Paramètres</strong></li>
  <li>Onglet <strong>Vie privée et sécurité</strong></li>
  <li>Descends jusqu’à <strong>Certificats</strong></li>
  <li>Clique sur <strong>Afficher les certificats</strong></li>
  <li>Onglet <strong>Vos certificats</strong> → <strong>Importer</strong></li>
  <li>Sélectionne ton fichier <code class="language-plaintext highlighter-rouge">.p12</code> → entre le mot de passe</li>
</ol>

<hr />

<h2 id="️-étape-4--installation-via-powershell-option-automatisée">⚙️ Étape 4 : Installation via PowerShell (option automatisée)</h2>

<p>Si tu préfères la méthode en ligne de commande :</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Read-Host</span><span class="w"> </span><span class="nt">-AsSecureString</span><span class="w"> </span><span class="s2">"Mot de passe du fichier .p12"</span><span class="w">
</span><span class="n">Import-PfxCertificate</span><span class="w"> </span><span class="nt">-FilePath</span><span class="w"> </span><span class="s2">"C:\Users\&lt;ton_user&gt;\Documents\moncertificat.p12"</span><span class="w"> </span><span class="nt">-CertStoreLocation</span><span class="w"> </span><span class="s2">"Cert:\CurrentUser\My"</span><span class="w"> </span><span class="nt">-Password</span><span class="w"> </span><span class="nv">$password</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>📍 <code class="language-plaintext highlighter-rouge">Cert:\CurrentUser\My</code> = magasin “Personnel” de l’utilisateur</li>
  <li>🔒 Nécessite <strong>aucun privilège administrateur</strong></li>
</ul>

<hr />

<h2 id="-étape-5--vérification-via-powershell">🧾 Étape 5 : Vérification via PowerShell</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Get-ChildItem</span><span class="w"> </span><span class="nx">Cert:\CurrentUser\My</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-List</span><span class="w"> </span><span class="nx">Subject</span><span class="p">,</span><span class="w"> </span><span class="nx">Issuer</span><span class="p">,</span><span class="w"> </span><span class="nx">NotAfter</span><span class="w">
</span></code></pre></div></div>

<p>Tu verras ton certificat avec :</p>
<ul>
  <li><strong>Subject</strong> (ton nom / identifiant)</li>
  <li><strong>Issuer</strong> (autorité émettrice)</li>
  <li><strong>NotAfter</strong> (date d’expiration)</li>
</ul>

<hr />

<h2 id="-résumé">✅ Résumé</h2>

<table>
  <thead>
    <tr>
      <th>Étape</th>
      <th>Action</th>
      <th>Détail</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Double-cliquer sur <code class="language-plaintext highlighter-rouge">.p12</code></td>
      <td>Lancer l’assistant d’importation</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Choisir “Utilisateur actuel”</td>
      <td>Installation pour ton compte</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Entrer le mot de passe</td>
      <td>Déverrouille le fichier</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Choisir “Personnel”</td>
      <td>Emplacement correct pour navigateur</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Vérifier via navigateur</td>
      <td>Chrome/Edge = magasin Windows, Firefox = import manuel</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-astuce">💡 Astuce</h2>
<p>Tu peux <strong>exporter</strong> ce certificat vers un autre poste Windows ou macOS :</p>
<ol>
  <li>Ouvre <code class="language-plaintext highlighter-rouge">certmgr.msc</code></li>
  <li>Dossier <strong>Personnel → Certificats</strong></li>
  <li>Clique droit → <strong>Toutes les tâches → Exporter</strong></li>
  <li>Coche <em>“Exporter la clé privée”</em> → choisis le format <code class="language-plaintext highlighter-rouge">.pfx</code></li>
  <li>Protège-le avec un mot de passe fort 🔐</li>
</ol>]]></content><author><name>Brahim MACHKOURI</name></author><category term="système" /><category term="certificat" /><category term="windows" /><summary type="html"><![CDATA[⚖️ Guide d’installation d’un certificat .p12 dans Windows 11 (utilisateur courant / navigateur web) 🎯 Objectif Installer un certificat client au format .p12 pour une utilisation dans les navigateurs web tels que Edge, Chrome ou Firefox, pour l’utilisateur courant. 🥉 Étape 1 : Comprendre le fichier .p12 Un fichier .p12 contient : 🔐 Le certificat utilisateur 🔑 La clé privée 🧾 Éventuellement la chaîne de certification (autorité intermédiaire / racine) Ce fichier est protégé par un mot de passe, que tu devras saisir lors de l’importation. 🦯o Étape 2 : Importation via l’interface graphique Double-clique sur le fichier moncertificat.p12 Sélectionne Utilisateur actuel car le certificat doit être disponible uniquement pour ton compte Windows Clique sur Suivant Clique sur Parcourir, puis sélectionne ton fichier .p12 Entre le mot de passe du certificat Coche : ✅ Marquer cette clé comme exportable ✅ Inclure toutes les propriétés étendues Sélectionne : Placer tous les certificats dans le magasin suivant Clique sur Parcourir → choisis Personnel Clique sur Suivant puis Terminer Un message “L’importation a réussi” s’affiche ✅ 🌐 Étape 3 : Vérification dans le navigateur Microsoft Edge / Google Chrome Ouvre les Paramètres Recherche certificats Va dans : Paramètres → Confidentialité et sécurité → Sécurité → Gérer les certificats Onglet Personnel → tu dois voir ton certificat listé. Mozilla Firefox Firefox n’utilise pas le magasin Windows par défaut. Menu ☰ → Paramètres Onglet Vie privée et sécurité Descends jusqu’à Certificats Clique sur Afficher les certificats Onglet Vos certificats → Importer Sélectionne ton fichier .p12 → entre le mot de passe ⚙️ Étape 4 : Installation via PowerShell (option automatisée) Si tu préfères la méthode en ligne de commande : $password = Read-Host -AsSecureString "Mot de passe du fichier .p12" Import-PfxCertificate -FilePath "C:\Users\&lt;ton_user&gt;\Documents\moncertificat.p12" -CertStoreLocation "Cert:\CurrentUser\My" -Password $password 📍 Cert:\CurrentUser\My = magasin “Personnel” de l’utilisateur 🔒 Nécessite aucun privilège administrateur 🧾 Étape 5 : Vérification via PowerShell Get-ChildItem Cert:\CurrentUser\My | Format-List Subject, Issuer, NotAfter Tu verras ton certificat avec : Subject (ton nom / identifiant) Issuer (autorité émettrice) NotAfter (date d’expiration) ✅ Résumé Étape Action Détail 1 Double-cliquer sur .p12 Lancer l’assistant d’importation 2 Choisir “Utilisateur actuel” Installation pour ton compte 3 Entrer le mot de passe Déverrouille le fichier 4 Choisir “Personnel” Emplacement correct pour navigateur 5 Vérifier via navigateur Chrome/Edge = magasin Windows, Firefox = import manuel 💡 Astuce Tu peux exporter ce certificat vers un autre poste Windows ou macOS : Ouvre certmgr.msc Dossier Personnel → Certificats Clique droit → Toutes les tâches → Exporter Coche “Exporter la clé privée” → choisis le format .pfx Protège-le avec un mot de passe fort 🔐]]></summary></entry><entry><title type="html">Lima - Ubuntu cheat sheet</title><link href="/theblog/syst%C3%A8me/2025/06/21/lima-cheat-sheet.html" rel="alternate" type="text/html" title="Lima - Ubuntu cheat sheet" /><published>2025-06-21T14:30:00+02:00</published><updated>2025-06-21T14:30:00+02:00</updated><id>/theblog/syst%C3%A8me/2025/06/21/lima-cheat-sheet</id><content type="html" xml:base="/theblog/syst%C3%A8me/2025/06/21/lima-cheat-sheet.html"><![CDATA[<p><img src="/theblog/assets/images/lima2.png" alt="LiMa" /></p>

<p>Lima (“<strong>Li</strong>nux virtual <strong>ma</strong>chines”) est un outil open-source qui permet de lancer facilement des machines virtuelles Linux sur macOS (et aussi Linux). Il vise à offrir une expérience “Linux-on-Mac” fluide pour les développeurs, tout en gardant une gestion simple et intégrée.</p>

<p>L’objectif est d’exécuter des outils Linux (Docker, Podman, Kubernetes, etc.) sur Mac dans un vrai environnement Linux, ce qui offre une compatibilité et un comportement identiques à un vrai serveur Linux.</p>

<h2 id="installation">Installation</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>lima
</code></pre></div></div>

<h2 id="-lister-les-templates-ubuntu-disponibles">📦 Lister les templates Ubuntu disponibles</h2>

<p>Il existe de nombreux templates disponibles (docker, podman, kubernetes, ubuntu, debian, fedora, opensuse, alpine, etc), mais ici, c’est Ubuntu qui nous intéresse :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl start <span class="nt">--list-templates</span> | <span class="nb">grep </span>ubuntu
</code></pre></div></div>

<p>✅ Affiche les templates Ubuntu disponibles localement.</p>

<p>✅ Exemples de templates :</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ubuntu</code> : Dernière LTS (ex: 22.04)</li>
  <li><code class="language-plaintext highlighter-rouge">ubuntu-lts</code> : Alias vers la dernière LTS stable</li>
  <li><code class="language-plaintext highlighter-rouge">ubuntu-20.04</code> : Ubuntu 20.04 LTS (Focal Fossa)</li>
  <li><code class="language-plaintext highlighter-rouge">ubuntu-22.04</code> : Ubuntu 22.04 LTS (Jammy Jellyfish)</li>
  <li><code class="language-plaintext highlighter-rouge">ubuntu-24.04</code> : Ubuntu 24.04 LTS (Noble Numbat)</li>
</ul>

<hr />

<h2 id="-créer-et-démarrer-une-vm-ubuntu-avec-une-version-précise">🚀 Créer et démarrer une VM Ubuntu avec une version précise</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Ubuntu LTS actuelle (ex: 22.04)</span>
limactl start <span class="nt">--name</span><span class="o">=</span>ubuntu-lts template://ubuntu-lts

<span class="c"># Ubuntu 20.04 (Focal Fossa) avec 2 CPU et 4 Go de RAM</span>
limactl start <span class="nt">--name</span><span class="o">=</span>ubuntu20 <span class="nt">--cpus</span><span class="o">=</span>2 <span class="nt">--memory</span><span class="o">=</span>4 <span class="nt">--disk</span><span class="o">=</span>5 template://ubuntu-20.04 

<span class="c"># Ubuntu 22.04 (Jammy Jellyfish) en mode Virtualization.framework avec Rosetta</span>
limactl start <span class="nt">--name</span><span class="o">=</span>ubuntu22 <span class="nt">--vm-type</span><span class="o">=</span>vz <span class="nt">--rosetta</span> template://ubuntu-22.04

<span class="c"># Ubuntu 24.04 (Noble Numbat) : 4 CPU, 8 Go de RAM, Virtualization.framework, Rosetta, montage virtiofs en écriture</span>
limactl start <span class="nt">--name</span><span class="o">=</span>ubuntu24 <span class="nt">--cpus</span><span class="o">=</span>4 <span class="nt">--memory</span><span class="o">=</span>8 <span class="nt">--vm-type</span><span class="o">=</span>vz <span class="nt">--rosetta</span> <span class="nt">--mount-type</span><span class="o">=</span>virtiofs <span class="nt">--mount-writable</span> template://ubuntu-24.04 

<span class="c"># Version non-LTS (ex: 24.10) ou future</span>
limactl start <span class="nt">--name</span><span class="o">=</span>ubuntu-dev template://ubuntu-25.04
</code></pre></div></div>

<p>🛠️ <strong>Paramètres courants :</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">--cpus=X</code> : Nombre de CPU alloué à la VM.</li>
  <li><code class="language-plaintext highlighter-rouge">--memory=Y</code> : Taille de la mémoire en Go (ex: <code class="language-plaintext highlighter-rouge">8</code> pour 8 Go).</li>
  <li><code class="language-plaintext highlighter-rouge">--disk=Z</code> : Taille du disque en Go (par défaut 100Go).</li>
  <li><code class="language-plaintext highlighter-rouge">--vm-type={qemu, vz}</code> : Type de machine virtuelle (<code class="language-plaintext highlighter-rouge">vz</code> pour macOS Ventura+ utilisant Virtualization.framework, plus performant).</li>
  <li><code class="language-plaintext highlighter-rouge">--rosetta</code> : Active Rosetta pour l’exécution de binaires x86_64 sur Mac Apple Silicon (nécessite <code class="language-plaintext highlighter-rouge">--vm-type=vz</code>).</li>
  <li><code class="language-plaintext highlighter-rouge">--mount-type={9p, virtiofs, reverse-sshfs}</code> : Type de montage (performant : <code class="language-plaintext highlighter-rouge">virtiofs</code> avec <code class="language-plaintext highlighter-rouge">vz</code>).</li>
  <li><code class="language-plaintext highlighter-rouge">--mount-writable</code> : Donne accès en écriture au montage du répertoire de l’hôte.</li>
</ul>

<p>🐚 <strong>Alternative interactive :</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl start
</code></pre></div></div>
<p>➡️ Choisir le template dans l’interface interactive.</p>

<hr />

<h2 id="️-accéder-à-la-vm">🖥️ Accéder à la VM</h2>

<p>Interface lima0, @IP et @mac de la VM :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl shell ubuntu24 bash <span class="nt">-c</span> <span class="s2">"echo lima0 </span><span class="se">\$</span><span class="s2">(ip -4 -o addr show lima0 | awk '{print </span><span class="se">\$</span><span class="s2">4}' | cut -d/ -f1) </span><span class="se">\$</span><span class="s2">(ip link show lima0 | awk '/link</span><span class="se">\\</span><span class="s2">/ether/ {print </span><span class="se">\$</span><span class="s2">2}')"</span>
lima0 192.168.69.16 55:55:55:60:ee:34
</code></pre></div></div>

<p>La commande <strong>lima</strong> est un alias pour “limactl shell default”. Le nom de l’instance par défaut (“default”) peut être changé via la variable $LIMA_INSTANCE.</p>

<p>Exemple :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">LIMA_INSTANCE</span><span class="o">=</span><span class="s2">"myubu24"</span>
</code></pre></div></div>

<p>Le shell et le répertoire initial (workdir) dans l’instance peuvent être spécifiés via $LIMA_SHELL et $LIMA_WORKDIR.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Commande standard pour entrer dans la VM</span>
lima

<span class="c"># Commande standard pour n'importe quelle VM </span>
limactl shell &lt;nom_vm&gt;

<span class="c"># Exemple :</span>
limactl shell myubu24

<span class="c"># Accès SSH avancé (pour scripts, par exemple)</span>
<span class="nv">ip</span><span class="o">=</span><span class="si">$(</span>limactl shell myubu24 ip <span class="nt">-4</span> addr show lima0 | <span class="nb">grep </span>inet | <span class="nb">awk</span> <span class="s1">'{print $2}'</span> | <span class="nb">cut</span> <span class="nt">-d</span>/ <span class="nt">-f1</span><span class="si">)</span>
ssh <span class="nt">-o</span> <span class="nv">IdentitiesOnly</span><span class="o">=</span><span class="nb">yes</span> <span class="nt">-i</span> ~/.lima/_config/user <span class="nt">-p</span> 22 <span class="si">$(</span><span class="nb">whoami</span><span class="si">)</span>@<span class="nv">$ip</span>
</code></pre></div></div>

<hr />

<h2 id="-gérer-la-vm">🛑 Gérer la VM</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl list         <span class="c"># Lister toutes les VM</span>
limactl stop         <span class="c"># Arrêter une VM</span>
limactl start        <span class="c"># Démarrer une VM arrêtée</span>
limactl restart      <span class="c"># Redémarrer une VM</span>
limactl delete       <span class="c"># Supprimer une VM (demande confirmation)</span>
</code></pre></div></div>

<p>⚠️ <code class="language-plaintext highlighter-rouge">limactl delete</code> supprime les disques et la configuration de la VM.</p>

<hr />

<h2 id="-copier-des-fichiers-entre-hôte-mac-et-vm">📂 Copier des fichiers entre hôte (Mac) et VM</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl <span class="nb">cp</span> &lt;<span class="nb">source</span><span class="o">&gt;</span> &lt;destination&gt;
</code></pre></div></div>

<h3 id="depuis-le-mac-vers-la-vm">Depuis le Mac vers la VM</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl <span class="nb">cp</span> ./mon_fichier.txt myubu24:~/
</code></pre></div></div>

<h3 id="depuis-la-vm-vers-le-mac">Depuis la VM vers le Mac</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl <span class="nb">cp </span>myubu24:~/rapport.pdf ./
</code></pre></div></div>

<h3 id="copier-un-répertoire-récursivement">Copier un répertoire récursivement</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl <span class="nb">cp</span> <span class="nt">-r</span>  ./ma_source myubu24:/ma_destination
</code></pre></div></div>

<hr />

<h2 id="️-personnaliser-la-configuration-de-la-vm">⚙️ Personnaliser la configuration de la VM</h2>

<h3 id="editer-la-configuration-post-création-à-froid">Editer la configuration post-création (à froid)</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl stop
limactl edit 
</code></pre></div></div>

<p>Exemple (fragment) :</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">cpus</span><span class="pi">:</span> <span class="m">4</span>
<span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">8GiB"</span>
<span class="na">disk</span><span class="pi">:</span> <span class="s2">"</span><span class="s">50GiB"</span>
<span class="na">mounts</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">location</span><span class="pi">:</span> <span class="s2">"</span><span class="s">~"</span>
    <span class="na">writable</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="c1">#virtiofs: true  # Utiliser pour vz si nécessaire</span>
</code></pre></div></div>

<p>Après modification, redémarrer la VM :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl start 
</code></pre></div></div>

<h3 id="création-avancée-avec-fichier-de-configuration-yaml">Création avancée avec fichier de configuration YAML</h3>
<ol>
  <li>Créez un fichier <code class="language-plaintext highlighter-rouge">config.yaml</code> avec le contenu souhaité :</li>
</ol>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">images</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">location</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://cloud-images.ubuntu.com/releases/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img"</span>
    <span class="na">arch</span><span class="pi">:</span> <span class="s2">"</span><span class="s">x86_64"</span>
<span class="na">mounts</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">location</span><span class="pi">:</span> <span class="s2">"</span><span class="s">~"</span>
    <span class="na">writable</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">cpus</span><span class="pi">:</span> <span class="m">4</span>
<span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">8GiB"</span>
<span class="na">vmType</span><span class="pi">:</span> <span class="s2">"</span><span class="s">vz"</span>
<span class="na">rosetta</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">mountType</span><span class="pi">:</span> <span class="s2">"</span><span class="s">virtiofs"</span>
</code></pre></div></div>

<ol>
  <li>Lancez Lima en spécifiant le fichier de configuration :</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl start <span class="nt">--name</span><span class="o">=</span>ubuntu24-advanced <span class="nt">--file</span> config.yaml
</code></pre></div></div>

<hr />

<h2 id="snapshots">Snapshots</h2>

<p>Les <a href="https://lima-vm.io/docs/reference/limactl_snapshot_create/">snapshots</a> pour la version macOS n’ont pas l’air d’être implémentées :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>limactl snapshot create ubuntu24 <span class="nt">--tag</span> snap1
WARN[0000] <span class="sb">`</span>limactl snapshot<span class="sb">`</span> is experimental
FATA[0000] unimplemented
</code></pre></div></div>
<hr />

<h2 id="-vérifier-la-version-ubuntu-dans-la-vm">📝 Vérifier la version Ubuntu dans la VM</h2>

<p>Une fois connecté à la VM :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lsb_release <span class="nt">-a</span>
</code></pre></div></div>

<p>Ou :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /etc/os-release
</code></pre></div></div>

<p>Commande depuis le Mac sans se connecter via un shell :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>limactl shell ubuntu24 <span class="nt">--</span> lsb_release <span class="nt">-d</span>
</code></pre></div></div>

<hr />

<h2 id="ℹ️-infos-rapides-sur-les-fichiers-de-la-vm-myubu24">ℹ️ Infos rapides sur les fichiers de la VM “myubu24”</h2>

<p>Supposons qu’une VM avec le nom “myubu24” existe, les fichiers sont dans ~/.lima :</p>

<pre><code class="language-brew">.lima/
├── _config
│   ├── networks.yaml         # Config réseau
│   ├── user                  # Clé privée
│   └── user.pub              # Clé publique
└── myubu24
    ├── basedisk &lt;--- 578 Mo  # Image disque de base (cloudimg) utilisée
    ├── cidata.iso            # Image cloud-init (seed ISO)
    ├── cloud-config.yaml     # Configuration de la VM
    ├── default_ep.sock
    ├── default_fd.sock
    ├── diffdisk &lt;----100 Go  # Overlay du disque (état de la VM)
    ├── ha.pid
    ├── ha.sock
    ├── ha.stderr.log
    ├── ha.stdout.log         # Logs du superviseur/agent VM
    ├── lima-version
    ├── lima.yaml             # Config YAML de la VM
    ├── serialv.log           # Log de la console série
    ├── ssh.config
    ├── ssh.sock
    ├── vz-efi
    ├── vz-identifier
    └── vz.pid
</code></pre>

<h2 id="ℹ️-infos-sur-les-images">ℹ️ Infos sur les images</h2>

<ul>
  <li><strong>Source des images</strong> : Lima utilise les <a href="https://cloud-images.ubuntu.com/">cloud-images Ubuntu</a> au format QCOW2 (KVM/QEMU).</li>
  <li><strong>Mises à jour</strong> : La première fois, l’image est téléchargée puis mise en cache.</li>
  <li><strong>Non conteneur</strong> : Lima fonctionne avec des machines virtuelles complètes (QEMU ou Virtualization.framework), pas des conteneurs LXC.</li>
</ul>

<hr />

<h2 id="-astuces-lima--ubuntu">💡 Astuces Lima + Ubuntu</h2>

<ul>
  <li><strong>Hostname par défaut</strong> : <code class="language-plaintext highlighter-rouge">lima-&lt;nom_vm&gt;</code></li>
  <li><strong>Utilisateur par défaut</strong> : <code class="language-plaintext highlighter-rouge">limactl shell ubuntu24 whoami</code> (avec accès sudo sans mot de passe)</li>
  <li><strong>Répertoire monté par défaut</strong> : le répertoire home de l’utilisateur Mac est monté à la racine / : <code class="language-plaintext highlighter-rouge">/Users/&lt;nom_user&gt;</code>.</li>
  <li><strong>Accès SSH avancé</strong> : Voir <code class="language-plaintext highlighter-rouge">~/.lima/&lt;nom_vm&gt;/ssh.config</code> pour la configuration SSH complète.</li>
</ul>

<hr />

<h2 id="-liens-utiles">🔗 Liens utiles</h2>

<ul>
  <li><a href="https://lima-vm.io/">Documentation officielle de Lima</a></li>
  <li><a href="https://cloud-images.ubuntu.com/">Liste des images cloud Ubuntu</a></li>
  <li><a href="https://github.com/lima-vm/lima">Github de Lima</a></li>
</ul>

<hr />

<blockquote>
  <p><strong>Résumé workflow :</strong></p>
  <ol>
    <li><code class="language-plaintext highlighter-rouge">limactl start --name=... template://...</code> (avec options)</li>
    <li><code class="language-plaintext highlighter-rouge">limactl shell ...</code> pour se connecter</li>
    <li>Utiliser la VM comme un vrai système Ubuntu</li>
    <li><code class="language-plaintext highlighter-rouge">limactl stop ...</code> pour arrêter</li>
  </ol>
</blockquote>

<blockquote>
  <p><strong>Pro tips :</strong></p>
  <ul>
    <li>Pour les Mac Apple Silicon : toujours privilégier <code class="language-plaintext highlighter-rouge">--vm-type=vz</code> et <code class="language-plaintext highlighter-rouge">--rosetta</code>.</li>
    <li><code class="language-plaintext highlighter-rouge">--mount-type=virtiofs</code> offre les meilleures performances de partage de fichiers.</li>
    <li>Configurer les montages en écriture avec <code class="language-plaintext highlighter-rouge">--mount-writable</code>.</li>
  </ul>
</blockquote>]]></content><author><name>Brahim MACHKOURI</name></author><category term="système" /><category term="virtualisation" /><category term="macos" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">Guide d’activation de Windows 11</title><link href="/theblog/syst%C3%A8me/2025/06/16/guide-activation-windows-11.html" rel="alternate" type="text/html" title="Guide d’activation de Windows 11" /><published>2025-06-16T15:00:00+02:00</published><updated>2025-06-16T15:00:00+02:00</updated><id>/theblog/syst%C3%A8me/2025/06/16/guide-activation-windows-11</id><content type="html" xml:base="/theblog/syst%C3%A8me/2025/06/16/guide-activation-windows-11.html"><![CDATA[<p><img src="/theblog/assets/images/activation.png" alt="activation" /></p>

<blockquote>
  <p>Ce guide pas-à-pas explique comment saisir une nouvelle clé de produit.</p>
</blockquote>

<h2 id="prérequis">Prérequis</h2>

<ul>
  <li><strong>Droits administrateur</strong> sur la machine.</li>
  <li><strong>Connexion Internet</strong> fonctionnelle (obligatoire pour l’activation en ligne).</li>
  <li><strong>Clé de produit Windows 11</strong> valide (25 caractères, format <code class="language-plaintext highlighter-rouge">XXXXX-XXXXX-XXXXX-XXXXX-XXXXX</code>).</li>
</ul>

<hr />

<p><img src="/theblog/assets/images/activation1.png" alt="Recherche « activation » dans le menu Démarrer" /></p>

<h2 id="étape1-ouvrir-les-paramètres-dactivation">Étape 1 : ouvrir les paramètres d’activation</h2>

<p><img src="activation1.png" alt="Recherche « activation » dans le menu Démarrer" /></p>

<ol>
  <li>Cliquez sur le bouton <strong>Démarrer</strong> (ou appuyez sur la touche <strong>Windows</strong>).</li>
  <li>Tapez <strong>activation</strong> dans la barre de recherche (flèche 1).</li>
  <li>Cliquez sur <strong>Ouvrir</strong> sous <em>Paramètres d’activation</em> (flèche 2).</li>
</ol>

<hr />

<p><img src="/theblog/assets/images/activation2.png" alt="Fenêtre Système &gt; Activation" /></p>

<h2 id="étape2-vérifier-létat-dactivation">Étape 2 : vérifier l’état d’activation</h2>

<p><img src="activation2.png" alt="Fenêtre Système &gt; Activation" /></p>

<ul>
  <li>La ligne <strong>État d’activation</strong> indique si Windows est <strong>Actif</strong>.</li>
  <li>Pour changer la clé, sélectionnez <strong>Modifier la clé de produit</strong> (flèche verte).</li>
</ul>

<hr />

<p><img src="/theblog/assets/images/activation3.png" alt="Fenêtre « Saisir une clé de produit »" /></p>

<h2 id="étape3-saisir-une-nouvelle-clé-de-produit">Étape 3 : saisir une nouvelle clé de produit</h2>

<p><img src="activation3.png" alt="Fenêtre « Saisir une clé de produit »" /></p>

<ol>
  <li>Saisissez votre nouvelle clé (25 caractères).</li>
  <li>Cliquez sur <strong>Suivant</strong> puis sur <strong>Activer</strong>.</li>
  <li>Attendez la confirmation. Un symbole ✓ confirme la réussite.</li>
</ol>

<hr />

<h2 id="dépannage">Dépannage</h2>

<table>
  <thead>
    <tr>
      <th>Code d’erreur</th>
      <th>Signification</th>
      <th>Correctif rapide</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">0xC004F050</code></td>
      <td>Clé invalide</td>
      <td>Vérifier la clé et ressaisir.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">0xC004F074</code></td>
      <td>Serveur injoignable</td>
      <td>Vérifier la connexion Internet et réessayer.</td>
    </tr>
  </tbody>
</table>

<p>Pour d’autres codes, ouvrez <strong>Paramètres &gt; Système &gt; Activation &gt; Résoudre les problèmes d’activation</strong>.</p>

<hr />

<h2 id="pour-aller-plus-loin">Pour aller plus loin</h2>

<ul>
  <li><a href="https://support.microsoft.com/windows/activation">Documentation officielle Microsoft</a></li>
  <li>Commande avancée : <code class="language-plaintext highlighter-rouge">slmgr /dlv</code> dans un PowerShell <em>en tant qu’administrateur</em> pour un rapport détaillé.</li>
</ul>]]></content><author><name>Brahim MACHKOURI</name></author><category term="système" /><category term="activation" /><category term="windows" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">Bug Proxy dans Docker Desktop 4.42.0</title><link href="/theblog/syst%C3%A8me/2025/06/15/bug-proxy-docker-desktop-4-42-0.html" rel="alternate" type="text/html" title="Bug Proxy dans Docker Desktop 4.42.0" /><published>2025-06-15T15:00:00+02:00</published><updated>2025-06-15T15:00:00+02:00</updated><id>/theblog/syst%C3%A8me/2025/06/15/bug-proxy-docker-desktop-4-42-0</id><content type="html" xml:base="/theblog/syst%C3%A8me/2025/06/15/bug-proxy-docker-desktop-4-42-0.html"><![CDATA[<p><img src="/theblog/assets/images/docker-proxy-bug.png" alt="BugProxy" /></p>

<p>Il y a un problème de détection de proxy dans la version 4.42.0 de Docker Desktop qui touche toutes les plateformes.</p>

<p>La solution pour l’instant est d’aller dans Resources &gt; Proxies, et activer la configuration proxy manuelle.</p>]]></content><author><name>Brahim MACHKOURI</name></author><category term="système" /><category term="docker" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">Installation de LinkAce via Portainer</title><link href="/theblog/dev/2025/06/07/installer-linkace-via-portainer.html" rel="alternate" type="text/html" title="Installation de LinkAce via Portainer" /><published>2025-06-07T15:00:00+02:00</published><updated>2025-06-07T15:00:00+02:00</updated><id>/theblog/dev/2025/06/07/installer-linkace-via-portainer</id><content type="html" xml:base="/theblog/dev/2025/06/07/installer-linkace-via-portainer.html"><![CDATA[<p><img src="/theblog/assets/images/linkace.png" alt="LinkAce" /></p>

<p><a href="https://www.linkace.org/">LinkAce</a> est une application web libre et open-source qui permet de gérer, organiser et archiver tes favoris (liens/bookmarks) de manière centralisée, auto-hébergée et collaborative.</p>

<p>Voici le docker-compose pour la Stack dans Portainer :</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3.7"</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">linkace</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">linkace/linkace:latest</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">linkace</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">db</span>
      <span class="pi">-</span> <span class="s">redis</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8080:80"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">linkace-app-data:/app/storage</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">APP_KEY=base64:&lt;clé_à_générer&gt;</span>
      <span class="pi">-</span> <span class="s">APP_URL=http://localhost:8080</span>
      <span class="pi">-</span> <span class="s">DB_CONNECTION=mysql</span>
      <span class="pi">-</span> <span class="s">DB_HOST=db</span>
      <span class="pi">-</span> <span class="s">DB_PORT=3306</span>
      <span class="pi">-</span> <span class="s">DB_DATABASE=linkace</span>
      <span class="pi">-</span> <span class="s">DB_USERNAME=linkace</span>
      <span class="pi">-</span> <span class="s">DB_PASSWORD=motdepassefort</span>
      <span class="pi">-</span> <span class="s">REDIS_HOST=redis</span>
      <span class="pi">-</span> <span class="s">REDIS_PASSWORD=unautremdpfort</span>
      <span class="pi">-</span> <span class="s">APP_DEBUG=true</span>
      <span class="pi">-</span> <span class="s">APP_TIMEZONE=Europe/Paris</span>

  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mariadb:11.5</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">linkace-db</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MYSQL_ROOT_PASSWORD=motdepassefort</span>
      <span class="pi">-</span> <span class="s">MYSQL_DATABASE=linkace</span>
      <span class="pi">-</span> <span class="s">MYSQL_USER=linkace</span>
      <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=motdepassefort</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">mariadbd --character-set-server=utf8mb4 --collation-server=utf8mb4_bin</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">linkace-db-data:/var/lib/mysql</span>

  <span class="na">redis</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">bitnami/redis:7.4</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">linkace-redis</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">REDIS_PASSWORD=unautremdpfort</span>

<span class="na">volumes</span><span class="pi">:</span>
  <span class="na">linkace-app-data</span><span class="pi">:</span>
  <span class="na">linkace-db-data</span><span class="pi">:</span>
</code></pre></div></div>

<p>Pour générer la clé :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--rm</span> linkace/linkace php artisan key:generate <span class="nt">--show</span> 
</code></pre></div></div>

<h3 id="import">Import</h3>

<p>Il faut d’abord générer un Cron Token. Aller dans System Settings (http://127.0.0.1:8080/settings/system) et cliquer sur le bouton <strong>Generate Token</strong>.</p>

<p>Il est possible d’importer des liens à partir d’un export Firefox par exemple (bookmarks.html).</p>

<p>Aller dans Import (http://127.0.0.1:8080/import) afin d’aller chercher le fichier bookmarks.html, puis cliquer sur le bouton <strong>Start Import</strong>.</p>

<p>Ensuite, il convient de planifier, directement sur la machine hôte (celle qui exécute Docker, que ce soit votre ordinateur ou un serveur distant), une tâche cron toutes les minutes, par exemple, afin de lancer le traitement d’importation par lots.</p>

<p>Pour créer un nouveau cron :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-e</span>
</code></pre></div></div>

<p>Puis saisir cette ligne dans le fichier :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* * * * * wget -qO- http://localhost:8080/cron/{Mettre_ici_le_Cron_Token} &gt;&gt; /tmp/linkace_import.log 2&gt;&amp;1
</code></pre></div></div>]]></content><author><name>Brahim MACHKOURI</name></author><category term="dev" /><category term="mysql" /><category term="mariadb" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">Attribution de privilèges MySQL/MariaDB</title><link href="/theblog/dev/2025/06/02/attribution-privileges-mariadb.html" rel="alternate" type="text/html" title="Attribution de privilèges MySQL/MariaDB" /><published>2025-06-02T15:00:00+02:00</published><updated>2025-06-02T15:00:00+02:00</updated><id>/theblog/dev/2025/06/02/attribution-privileges-mariadb</id><content type="html" xml:base="/theblog/dev/2025/06/02/attribution-privileges-mariadb.html"><![CDATA[<p>Accorder des privilèges à un utilisateur sur une base de données MariaDB/MySQL, avec gestion des accès depuis différentes adresses IP et bonnes pratiques.</p>

<hr />

<h3 id="syntaxe-moderne-mysql-80--mariadb-102">Syntaxe moderne (MySQL 8.0+ / MariaDB 10.2+)</h3>

<p>La bonne pratique actuelle consiste à séparer la création d’utilisateur de l’attribution des privilèges :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- 1. Créer l'utilisateur</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'nom_utilisateur'</span><span class="o">@</span><span class="s1">'%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'mot_de_passe'</span><span class="p">;</span>

<span class="c1">-- 2. Accorder les privilèges</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">nom_base</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'nom_utilisateur'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>

<span class="c1">-- 3. Appliquer les changements</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="paramètres">Paramètres</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">nom_base</code> : nom de la base de données</li>
  <li><code class="language-plaintext highlighter-rouge">nom_utilisateur</code> : nom de l’utilisateur MariaDB/MySQL</li>
  <li><code class="language-plaintext highlighter-rouge">mot_de_passe</code> : mot de passe associé</li>
  <li><code class="language-plaintext highlighter-rouge">@'%'</code> : autorise l’accès depuis toutes les adresses IP</li>
</ul>

<blockquote>
  <p>💡 <strong>Pourquoi cette approche ?</strong> Elle offre plus de flexibilité, une meilleure gestion des erreurs et respecte le principe de séparation des responsabilités.</p>
</blockquote>

<hr />

<h3 id="exemple-pratique">Exemple pratique</h3>

<p>Créons un utilisateur pour une application e-commerce :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Étape 1 : Créer l'utilisateur</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'ecommerce_user'</span><span class="o">@</span><span class="s1">'%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'SecurePass2025!'</span><span class="p">;</span>

<span class="c1">-- Étape 2 : Créer la base de données (si nécessaire)</span>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">boutique_en_ligne</span><span class="p">;</span>

<span class="c1">-- Étape 3 : Accorder les privilèges</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">boutique_en_ligne</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'ecommerce_user'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>

<span class="c1">-- Étape 4 : Appliquer les changements</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>

<span class="c1">-- Étape 5 : Vérifier que tout fonctionne</span>
<span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span> <span class="s1">'ecommerce_user'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="résultat-attendu">Résultat attendu</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-----------------------------------------------------------------------+
| Grants <span class="k">for </span>ecommerce_user@%                                           |
+-----------------------------------------------------------------------+
| GRANT USAGE ON <span class="k">*</span>.<span class="k">*</span> TO <span class="sb">`</span>ecommerce_user<span class="sb">`</span>@<span class="sb">`</span>%<span class="sb">`</span>                            |
| GRANT ALL PRIVILEGES ON <span class="sb">`</span>boutique_en_ligne<span class="sb">`</span>.<span class="k">*</span> TO <span class="sb">`</span>ecommerce_user<span class="sb">`</span>@<span class="sb">`</span>%<span class="sb">`</span> |
+-----------------------------------------------------------------------+
</code></pre></div></div>

<hr />

<h3 id="gestion-des-utilisateurs-existants">Gestion des utilisateurs existants</h3>

<h4 id="vérifier-lexistence-dun-utilisateur">Vérifier l’existence d’un utilisateur</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">User</span><span class="p">,</span> <span class="k">Host</span> <span class="k">FROM</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span> <span class="k">WHERE</span> <span class="k">User</span> <span class="o">=</span> <span class="s1">'webadmin'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="recréer-un-utilisateur-mariadb-1013--mysql-80">Recréer un utilisateur (MariaDB 10.1.3+ / MySQL 8.0+)</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DROP</span> <span class="k">USER</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'MotDePasseFort2025!'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">boutique_en_ligne</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="modifier-un-utilisateur-existant">Modifier un utilisateur existant</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Changer le mot de passe (syntaxe moderne)</span>
<span class="k">ALTER</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'NouveauMotDePasse2025!'</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<h3 id="variantes-de-restrictions-daccès">Variantes de restrictions d’accès</h3>

<h4 id="accès-depuis-une-ip-précise">Accès depuis une IP précise</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'192.168.1.42'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'MotDePasseFort2025!'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">boutique_en_ligne</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'192.168.1.42'</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="accès-depuis-un-sous-réseau-local">Accès depuis un sous-réseau local</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'192.168.1.%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'MotDePasseFort2025!'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">boutique_en_ligne</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'192.168.1.%'</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="accès-depuis-localhost-uniquement">Accès depuis localhost uniquement</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'localhost'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'MotDePasseFort2025!'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">boutique_en_ligne</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'localhost'</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="accès-depuis-plusieurs-sources">Accès depuis plusieurs sources</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Créer plusieurs entrées pour le même utilisateur</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'localhost'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'MotDePasseFort123!'</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'192.168.1.%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'MotDePasseFort123!'</span><span class="p">;</span>

<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">projet_web</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'localhost'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">projet_web</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'192.168.1.%'</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<h3 id="privilèges-granulaires-recommandé-pour-la-production">Privilèges granulaires (recommandé pour la production)</h3>

<p>Au lieu d’utiliser <code class="language-plaintext highlighter-rouge">ALL PRIVILEGES</code>, accordez uniquement les droits nécessaires :</p>

<h4 id="privilèges-de-base-pour-une-application-web">Privilèges de base pour une application web</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">SELECT</span><span class="p">,</span> <span class="k">INSERT</span><span class="p">,</span> <span class="k">UPDATE</span><span class="p">,</span> <span class="k">DELETE</span> <span class="k">ON</span> <span class="n">projet_web</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="privilèges-étendus-pour-un-administrateur">Privilèges étendus pour un administrateur</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">SELECT</span><span class="p">,</span> <span class="k">INSERT</span><span class="p">,</span> <span class="k">UPDATE</span><span class="p">,</span> <span class="k">DELETE</span><span class="p">,</span> <span class="k">CREATE</span><span class="p">,</span> <span class="k">DROP</span><span class="p">,</span> <span class="k">ALTER</span><span class="p">,</span> <span class="k">INDEX</span> 
<span class="k">ON</span> <span class="n">projet_web</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="privilèges-en-lecture-seule">Privilèges en lecture seule</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">projet_web</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'readonly_user'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="liste-des-privilèges-principaux">Liste des privilèges principaux</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">SELECT</code> : lecture des données</li>
  <li><code class="language-plaintext highlighter-rouge">INSERT</code> : insertion de nouvelles données</li>
  <li><code class="language-plaintext highlighter-rouge">UPDATE</code> : modification des données existantes</li>
  <li><code class="language-plaintext highlighter-rouge">DELETE</code> : suppression des données</li>
  <li><code class="language-plaintext highlighter-rouge">CREATE</code> : création de tables/bases</li>
  <li><code class="language-plaintext highlighter-rouge">DROP</code> : suppression de tables/bases</li>
  <li><code class="language-plaintext highlighter-rouge">ALTER</code> : modification de structure</li>
  <li><code class="language-plaintext highlighter-rouge">INDEX</code> : gestion des index</li>
  <li><code class="language-plaintext highlighter-rouge">GRANT OPTION</code> : possibilité d’accorder des privilèges à d’autres</li>
</ul>

<hr />

<h3 id="configuration-réseau-requise">Configuration réseau requise</h3>

<p>Pour permettre les connexions distantes, vérifiez la configuration de MariaDB/MySQL :</p>

<h4 id="fichier-de-configuration-etcmysqlmycnf-ou-etcmycnf">Fichier de configuration (<code class="language-plaintext highlighter-rouge">/etc/mysql/my.cnf</code> ou <code class="language-plaintext highlighter-rouge">/etc/my.cnf</code>)</h4>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[mysqld]</span><span class="w">
</span><span class="c"># Commenter ou modifier cette ligne pour autoriser les connexions distantes
# bind-address = 127.0.0.1
</span><span class="py">bind-address</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">0.0.0.0</span>
<span class="w">
</span><span class="c"># Ou spécifier une IP précise
# bind-address = 192.168.1.10
</span></code></pre></div></div>

<h4 id="redémarrer-le-service">Redémarrer le service</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl restart mysql
<span class="c"># ou</span>
<span class="nb">sudo </span>systemctl restart mariadb
</code></pre></div></div>

<hr />

<h3 id="vérification-et-maintenance">Vérification et maintenance</h3>

<h4 id="vérifier-les-droits-accordés">Vérifier les droits accordés</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="lister-tous-les-utilisateurs">Lister tous les utilisateurs</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">User</span><span class="p">,</span> <span class="k">Host</span><span class="p">,</span> <span class="n">authentication_string</span> <span class="k">FROM</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="vérifier-les-connexions-actives">Vérifier les connexions actives</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SHOW</span> <span class="n">PROCESSLIST</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<h3 id="révocation-des-privilèges">Révocation des privilèges</h3>

<h4 id="révoquer-des-privilèges-spécifiques">Révoquer des privilèges spécifiques</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">REVOKE</span> <span class="k">INSERT</span><span class="p">,</span> <span class="k">UPDATE</span> <span class="k">ON</span> <span class="n">projet_web</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="révoquer-tous-les-privilèges">Révoquer tous les privilèges</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">REVOKE</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">projet_web</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="supprimer-un-utilisateur">Supprimer un utilisateur</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DROP</span> <span class="k">USER</span> <span class="s1">'webadmin'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<h3 id="bonnes-pratiques-de-sécurité">Bonnes pratiques de sécurité</h3>

<h4 id="mots-de-passe">Mots de passe</h4>

<ul>
  <li>Utilisez des mots de passe forts (12+ caractères, mixte majuscules/minuscules/chiffres/symboles)</li>
  <li>Changez régulièrement les mots de passe</li>
  <li>Utilisez des gestionnaires de mots de passe</li>
</ul>

<h4 id="principe-du-moindre-privilège">Principe du moindre privilège</h4>

<ul>
  <li>N’accordez que les privilèges strictement nécessaires</li>
  <li>Évitez <code class="language-plaintext highlighter-rouge">ALL PRIVILEGES</code> en production</li>
  <li>Créez des utilisateurs spécialisés par fonction</li>
</ul>

<h4 id="restrictions-réseau">Restrictions réseau</h4>

<ul>
  <li>Limitez l’accès aux IP nécessaires plutôt qu’utiliser <code class="language-plaintext highlighter-rouge">%</code></li>
  <li>Utilisez des VPN ou des tunnels SSH pour les accès distants</li>
  <li>Configurez un pare-feu approprié</li>
</ul>

<h4 id="exemple-darchitecture-sécurisée">Exemple d’architecture sécurisée</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Utilisateur application (lecture/écriture limitée)</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'app_user'</span><span class="o">@</span><span class="s1">'192.168.1.%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'AppPassword123!'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span><span class="p">,</span> <span class="k">INSERT</span><span class="p">,</span> <span class="k">UPDATE</span><span class="p">,</span> <span class="k">DELETE</span> <span class="k">ON</span> <span class="n">myapp</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'app_user'</span><span class="o">@</span><span class="s1">'192.168.1.%'</span><span class="p">;</span>

<span class="c1">-- Utilisateur admin (accès complet mais local uniquement)</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'db_admin'</span><span class="o">@</span><span class="s1">'localhost'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'AdminPassword456!'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">myapp</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'db_admin'</span><span class="o">@</span><span class="s1">'localhost'</span><span class="p">;</span>

<span class="c1">-- Utilisateur lecture seule pour les rapports</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">'reporter'</span><span class="o">@</span><span class="s1">'%'</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">'ReportPassword789!'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">myapp</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'reporter'</span><span class="o">@</span><span class="s1">'%'</span><span class="p">;</span>

<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<h3 id="dépannage-courant">Dépannage courant</h3>

<h4 id="erreur-access-denied">Erreur “Access denied”</h4>

<ol>
  <li>Vérifiez que l’utilisateur existe pour le bon host</li>
  <li>Vérifiez le mot de passe</li>
  <li>Contrôlez les privilèges accordés</li>
  <li>Vérifiez la configuration réseau</li>
</ol>

<h4 id="connexion-impossible-depuis-lextérieur">Connexion impossible depuis l’extérieur</h4>

<ol>
  <li>Vérifiez <code class="language-plaintext highlighter-rouge">bind-address</code> dans la configuration</li>
  <li>Contrôlez les règles de pare-feu</li>
  <li>Vérifiez que le port 3306 est ouvert</li>
  <li>Testez avec <code class="language-plaintext highlighter-rouge">telnet server_ip 3306</code></li>
</ol>

<h4 id="commandes-de-diagnostic">Commandes de diagnostic</h4>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Voir la configuration actuelle</span>
<span class="k">SHOW</span> <span class="n">VARIABLES</span> <span class="k">LIKE</span> <span class="s1">'bind_address'</span><span class="p">;</span>

<span class="c1">-- Voir les tentatives de connexion</span>
<span class="k">SHOW</span> <span class="n">STATUS</span> <span class="k">LIKE</span> <span class="s1">'Connections'</span><span class="p">;</span>

<span class="c1">-- Voir les erreurs de connexion</span>
<span class="k">SHOW</span> <span class="n">STATUS</span> <span class="k">LIKE</span> <span class="s1">'Aborted_connects'</span><span class="p">;</span>
</code></pre></div></div>]]></content><author><name>Brahim MACHKOURI</name></author><category term="dev" /><category term="mysql" /><category term="mariadb" /><summary type="html"><![CDATA[Accorder des privilèges à un utilisateur sur une base de données MariaDB/MySQL, avec gestion des accès depuis différentes adresses IP et bonnes pratiques.]]></summary></entry><entry><title type="html">Connexion à MS SQL Server en PHP sous Debian/Ubuntu</title><link href="/theblog/dev/2024/08/22/connexion-a-ms-sql-server-en-php-sous-ubuntu.html" rel="alternate" type="text/html" title="Connexion à MS SQL Server en PHP sous Debian/Ubuntu" /><published>2024-08-22T13:40:00+02:00</published><updated>2024-08-22T13:40:00+02:00</updated><id>/theblog/dev/2024/08/22/connexion-a-ms-sql-server-en-php-sous-ubuntu</id><content type="html" xml:base="/theblog/dev/2024/08/22/connexion-a-ms-sql-server-en-php-sous-ubuntu.html"><![CDATA[<p>Remarque : la procédure suivante a été réalisée pour une version 7.2 de PHP. Il se peut que vous deviez adapter quelques points…</p>

<p>Pour la suite, on suppose que le serveur Microsoft SQL Server écoute les requêtes sur le port 1433 (par défaut) et qu’un utilisateur admindb est configuré pour l’accès à la base tournois qui ne contient ici qu’une seule table :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+------------+
|   users    |
+------------+
|    id      |
|    nom     |
+------------+
</code></pre></div></div>
<p>Paramètres :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IP SQL Server : 10.0.0.15
Database : tournois
Username : admindb
Password : HercuLE
</code></pre></div></div>
<p>Pour installer le client SQL Server sous Debian ou Ubuntu :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt install freetds-common freetds-bin unixodbc tdsodbc php7.2-odbc
</code></pre></div></div>
<p>Redémarrer le démon PHP, puis remplir les fichiers de configuration :</p>

<p>Dans /etc/freetds/freetds.conf, ajouter :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[monserveur]
host = 10.0.0.15
port = 1433
tds version = 8.0
</code></pre></div></div>
<p>Dans /etc/odbcinst.ini, ajouter :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[FreeTDS]
Description = FreeTDS Driver
Driver = /usr/lib/x86_64-linux-gnu/odbc/libtdsodbc.so
Setup = /usr/lib/x86_64-linux-gnu/odbc/libtdsS.so
Dontdlclose = 1
</code></pre></div></div>
<p>Dans /etc/odbc.ini, ajouter :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[MSSQLSRV]
Driver = FreeTDS
Description = ODBC connection via FreeTDS
#Server = 10.0.0.15
Servername = monserveur
Database = tournois
Port = 1433
</code></pre></div></div>
<p>Tester la connexion au serveur SQL Server à l’aide des outils tsql &amp; isql :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tsql -H 10.0.0.15 -p 1433 -U admindb -P HercuLE -D tournois
</code></pre></div></div>
<p>Si tout va bien, voici le résultat :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>locale is "en_US.UTF-8"
locale charset is "UTF-8"
using default charset "UTF-8"
Setting tournois as default database in login packet
1&gt;
</code></pre></div></div>
<p>Taper quit pour sortir.</p>

<p>Ensuite :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>isql -v MSSQLSRV admindb HercuLE
</code></pre></div></div>
<p>donnera :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+---------------------------------------+
| Connected!                            |
|                                       |
| sql-statement                         |
| help [tablename]                      |
| quit                                  |
|                                       |
+---------------------------------------+
SQL&gt;
</code></pre></div></div>
<p>Voici le code pour faire une requête en PHP :</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
 
<span class="nb">define</span><span class="p">(</span><span class="s1">'USER'</span><span class="p">,</span><span class="s1">'admindb'</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'PASSWORD'</span><span class="p">,</span><span class="s1">'HercuLE'</span><span class="p">);</span>
 
<span class="nv">$conn</span>   <span class="o">=</span> <span class="nb">odbc_connect</span><span class="p">(</span><span class="s2">"MSSQLSRV"</span><span class="p">,</span> <span class="no">USER</span><span class="p">,</span> <span class="no">PASSWORD</span><span class="p">);</span>
<span class="nv">$query</span>  <span class="o">=</span> <span class="s2">"select * from CT_USER"</span><span class="p">;</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nb">odbc_exec</span><span class="p">(</span> <span class="nv">$conn</span><span class="p">,</span> <span class="nv">$query</span> <span class="p">);</span>
 
<span class="k">while</span> <span class="p">(</span><span class="nb">odbc_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="nb">odbc_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>]]></content><author><name>Brahim MACHKOURI</name></author><category term="dev" /><category term="mssql" /><category term="php" /><category term="ubuntu" /><summary type="html"><![CDATA[Remarque : la procédure suivante a été réalisée pour une version 7.2 de PHP. Il se peut que vous deviez adapter quelques points…]]></summary></entry><entry><title type="html">Mermaid Markdown</title><link href="/theblog/dev/2023/10/17/mermaid.html" rel="alternate" type="text/html" title="Mermaid Markdown" /><published>2023-10-17T22:59:00+02:00</published><updated>2023-10-17T22:59:00+02:00</updated><id>/theblog/dev/2023/10/17/mermaid</id><content type="html" xml:base="/theblog/dev/2023/10/17/mermaid.html"><![CDATA[<p>Test de <a href="https://mermaid.js.org/intro/">Mermaid Markdown</a></p>

<p>Flowchart :</p>
<pre><code class="language-mermaid">  graph TD;
      A--&gt;B;
      A--&gt;C;
      B--&gt;D;
      C--&gt;D;
</code></pre>
<p>Sequence Diagram :</p>
<pre><code class="language-mermaid">sequenceDiagram
    participant Alice
    participant Bob
    Alice-&gt;&gt;John: Hello John, how are you?
    loop Healthcheck
        John-&gt;&gt;John: Fight against hypochondria
    end
    Note right of John: Rational thoughts &lt;br/&gt;prevail!
    John--&gt;&gt;Alice: Great!
    John-&gt;&gt;Bob: How about you?
    Bob--&gt;&gt;John: Jolly good!
</code></pre>
<p>Gantt :</p>
<pre><code class="language-mermaid">gantt
dateFormat  YYYY-MM-DD
title Adding GANTT diagram to mermaid
excludes weekdays 2014-01-10

section A section
Completed task            :done,    des1, 2014-01-06,2014-01-08
Active task               :active,  des2, 2014-01-09, 3d
Future task               :         des3, after des2, 5d
Future task2               :         des4, after des3, 5d
</code></pre>
<p>Diagramme de classe :</p>
<pre><code class="language-mermaid">classDiagram
Class01 &lt;|-- AveryLongClass : Cool
Class03 *-- Class04
Class05 o-- Class06
Class07 .. Class08
Class09 --&gt; C2 : Where am i?
Class09 --* C3
Class09 --|&gt; Class07
Class07 : equals()
Class07 : Object[] elementData
Class01 : size()
Class01 : int chimp
Class01 : int gorilla
Class08 &lt;--&gt; C2: Cool label
</code></pre>
<p>Graphique git :</p>
<pre><code class="language-mermaid">gitGraph
       commit
       commit
       branch develop
       commit
       commit
       commit
       checkout main
       commit
       commit
</code></pre>

<p>Entity Relationship Diagram - ❗ experimental</p>
<pre><code class="language-mermaid">erDiagram
    CUSTOMER ||--o{ ORDER : places
    ORDER ||--|{ LINE-ITEM : contains
    CUSTOMER }|..|{ DELIVERY-ADDRESS : uses
</code></pre>

<p>User Journey Diagram :</p>
<pre><code class="language-mermaid">journey
    title My working day
    section Go to work
      Make tea: 5: Me
      Go upstairs: 3: Me
      Do work: 1: Me, Cat
    section Go home
      Go downstairs: 5: Me
      Sit down: 5: Me
</code></pre>]]></content><author><name>Brahim MACHKOURI</name></author><category term="dev" /><category term="mermaid" /><summary type="html"><![CDATA[Test de Mermaid Markdown]]></summary></entry><entry><title type="html">Utilisation de pyenv sous macOS</title><link href="/theblog/macos/2023/01/16/macos-use-pyenv.html" rel="alternate" type="text/html" title="Utilisation de pyenv sous macOS" /><published>2023-01-16T11:01:15+01:00</published><updated>2023-01-16T11:01:15+01:00</updated><id>/theblog/macos/2023/01/16/macos-use-pyenv</id><content type="html" xml:base="/theblog/macos/2023/01/16/macos-use-pyenv.html"><![CDATA[<p>Pour utiliser différentes versions de Python sous macOS, <a href="https://github.com/pyenv/pyenv"><strong>pyenv</strong></a> est LA solution.</p>

<p>Pour l’installer, il faut d’abord installer les Xcode Tools :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xcode-select <span class="nt">--install</span>
</code></pre></div></div>

<p>Ainsi que quelques dépendances à l’aide de <a href="https://docs.brew.sh/Installation"><strong>brew</strong></a> :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>openssl readline sqlite3 xz zlib
</code></pre></div></div>

<p>Ensuite, cloner le repository et lancer l’installation :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/pyenv/pyenv.git ~/.pyenv
<span class="nb">cd</span> ~/.pyenv/ <span class="o">&amp;&amp;</span> src/configure <span class="o">&amp;&amp;</span> make <span class="nt">-C</span> src
</code></pre></div></div>

<p>Il faut maintenant éditer le fichier .zshrc ou .bash_profile pour y ajouter ceci à la fin :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PYENV_ROOT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.pyenv"</span> 
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$PYENV_ROOT</span><span class="s2">/bin:</span><span class="nv">$PATH</span><span class="s2">"</span> 
<span class="nb">eval</span> <span class="s2">"</span><span class="si">$(</span>pyenv init <span class="nt">--path</span><span class="si">)</span><span class="s2">"</span> 
<span class="nb">eval</span> <span class="s2">"</span><span class="si">$(</span>pyenv init -<span class="si">)</span><span class="s2">"</span>
</code></pre></div></div>

<p>Pour que les modifications soient bien prises en compte, il faut s’assurer de bien fermer le terminal (pressez <kbd>⌘</kbd>+<kbd>Q</kbd>) et le relancer.</p>

<p>Désormais, pour installer des versions de Python, procédez comme ceci :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv <span class="nb">install </span>3.11
pyenv <span class="nb">install </span>2.7.18
</code></pre></div></div>

<p>Et pour définir la version 3.11.1 comme version globale :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv global 3.11.1
</code></pre></div></div>

<p>Quittez le terminal, puis ouvrez-le à nouveau et testez :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv versions
python <span class="nt">-V</span>
</code></pre></div></div>

<p>Pour déclarer les versions 2 ET 3 de Python en global :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv global 3.11.1 2.7.18
</code></pre></div></div>
<p>Testez :</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-V</span>
python2
python3
</code></pre></div></div>]]></content><author><name>Brahim MACHKOURI</name></author><category term="macos" /><category term="python" /><category term="dev" /><summary type="html"><![CDATA[Pour utiliser différentes versions de Python sous macOS, pyenv est LA solution.]]></summary></entry><entry><title type="html">Connexion à un répertoire samba partagé avec macos</title><link href="/theblog/macos/2023/01/10/connexion-repertoire-samba.html" rel="alternate" type="text/html" title="Connexion à un répertoire samba partagé avec macos" /><published>2023-01-10T17:57:26+01:00</published><updated>2023-01-10T17:57:26+01:00</updated><id>/theblog/macos/2023/01/10/connexion-repertoire-samba</id><content type="html" xml:base="/theblog/macos/2023/01/10/connexion-repertoire-samba.html"><![CDATA[<p>⚠️ Utilisez le VPN de l’établissement si votre serveur de fichier est hébergé en interne.</p>

<p>Depuis le menu Finder, cliquez sur “Aller” &gt; “Se connecter au serveur…” (ou command+K):<br />
<img src="/theblog/assets/images/connect_samba_macos_img1.png" alt="image1" /></p>

<p>Dans le champ, saisissez “smb://login@adresseip”, en remplaçant login par votre propre login, et adresseip par l’adresse IP de votre serveur (1) :
<img src="/theblog/assets/images/connect_samba_macos_img2.png" alt="image2" /></p>

<p>Pour ajouter le serveur aux serveurs favoris, cliquez sur le bouton ‘+’ (2). Puis cliquez sur le bouton “Connecter” (3).</p>

<p>Cliquez une nouvelle fois sur “Se connecter” :
<img src="/theblog/assets/images/connect_samba_macos_img3.png" alt="image3" /></p>

<p>Lorsque la fenêtre suivante apparaît, entrez vos identifiants (1,2) et cliquez sur Enregistrer le mot de passe dans mon trousseau (3) pour éviter de le resaisir la fois prochaine.<br />
Cliquez sur le bouton “Connecter” (4) :
<img src="/theblog/assets/images/connect_samba_macos_img4.png" alt="image4" /></p>]]></content><author><name>Brahim MACHKOURI</name></author><category term="macos" /><category term="smb" /><category term="samba" /><category term="mac" /><summary type="html"><![CDATA[⚠️ Utilisez le VPN de l’établissement si votre serveur de fichier est hébergé en interne.]]></summary></entry></feed>